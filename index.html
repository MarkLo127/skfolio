
<!DOCTYPE html>


<html lang="en" data-content_root="./" data-theme="dark">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="_static/favicon-32x32.png" sizes="32x23" rel="icon" type="image/png">
    <link href="_static/favicon-16x16.png" sizes="16x12" rel="icon" type="image/png">
    <link rel="shortcut icon" sizes="any" href="_static/favicon.ico" type="image/x-icon">
    <link href="_static/android-chrome-192x192.png" sizes="192x136" rel="icon" type="image/png">
    <link rel="mask-icon" color="#459db9" href="_static/safari-pinned-tab.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="_static/apple-touch-icon.png" sizes="100x71" type="image/png">
    <meta name="msapplication-TileColor" content="#459db9">
    <meta name="theme-color" content="#ffffff">
    <meta name="msapplication-TileImage" content="mstile-150x150.png">
    <title>skfolio &#8212; skfolio 0.0.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "dark";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="_static/jupyterlite_sphinx.css?v=f996933d" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=0f37f9aa" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script src="_static/documentation_options.js?v=f131489c"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/jupyterlite_sphinx.js?v=f09d7af2"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
    <link rel="icon" href="_static/logo.svg"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="User Guide" href="user_guide/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="dark">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>


  <div class="bd-header-announcement container-fluid bd-header-announcement">
    <div class="bd-header-announcement__content"><div class="sidebar-message">
    If you'd like to contribute,
    <a href="https://github.com/skfolio/skfolio">check out our GitHub repository.</a>
    Your contributions are welcome!</div></div>
  </div>

  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
    
    <img src="_static/logo.svg" class="logo__image only-dark" alt="skfolio"/>
    <script>document.write(`<img src="_static/logo.svg" class="logo__image only-light" alt="skfolio"/>`);</script>
  
  
    <p class="title logo__title">skfolio</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="user_guide/index.html">
                         User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="auto_examples/index.html">
                         Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                         API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/skfolio/skfolio" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="user_guide/index.html">
                         User guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="auto_examples/index.html">
                         Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="api.html">
                         API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/skfolio/skfolio" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article"></div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="toctree-wrapper compound">
</div>
<section id="skfolio">
<h1>skfolio<a class="headerlink" href="#skfolio" title="Link to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">skfolio</span></code> is a Python library for portfolio optimization built on top of scikit-learn.
It provides a unified interface and <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> compatible tools to build, tune and
cross-validate portfolio models.</p>
<img alt="_images/expo.jpg" src="_images/expo.jpg" />
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">skfolio</span></code> is available on PyPI and conda-forge, and can be installed with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>skfolio
</pre></div>
</div>
</section>
<section id="key-concepts">
<h2>Key Concepts<a class="headerlink" href="#key-concepts" title="Link to this heading">#</a></h2>
<p>Since the development of modern portfolio theory by Markowitz (1952), mean-variance optimization (MVO)
has received considerable attention. Unfortunately it faces a number of shortcomings including high sensitivity to the
input parameters (expected returns and covariance), weight concentration, high turnover and poor out-of-sample
performance.
It is well known that naive allocation (1/N, inverse-vol, …) tend to outperform MVO out-of-sample (DeMiguel, 2007).</p>
<p>Numerous approaches have been developed to alleviate these shortcomings (shrinkage, bayesian approaches,
additional constraints, regularization, uncertainty set, higher moments, coherent risk measures,
left-tail risk optimization, distributionally robust optimization, factor model, risk-parity, hierarchical clustering,
ensemble methods…)</p>
<p>With this large number of methods, added to the fact that they can be composed together there is the need for an
unified framework to perform model selection, validation and parameter tuning while reducing the risk of data leakage
and overfitting. This framework is build on scikit-learn’s API.</p>
</section>
<section id="available-models">
<h2>Available models<a class="headerlink" href="#available-models" title="Link to this heading">#</a></h2>
<p>The current release contains:</p>
<ul class="simple">
<li><dl class="simple">
<dt>Optimization estimators:</dt><dd><ul>
<li><dl class="simple">
<dt>Naive:</dt><dd><ul>
<li><p>Equal-Weighted</p></li>
<li><p>Inverse-Volatility</p></li>
<li><p>Random (dirichlet)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Convex:</dt><dd><ul>
<li><p>Mean-Risk</p></li>
<li><p>Risk Budgeting</p></li>
<li><p>Maximum Diversification</p></li>
<li><p>Distributionally Robust CVaR</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Clustering:</dt><dd><ul>
<li><p>Hierarchical Risk Parity</p></li>
<li><p>Hierarchical Equal Risk Contribution</p></li>
<li><p>Nested Clusters Optimization</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Ensemble methods:</dt><dd><ul>
<li><p>Stacking Optimization</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Moment estimators:</dt><dd><ul>
<li><dl class="simple">
<dt>Expected Returns:</dt><dd><ul>
<li><p>Empirical</p></li>
<li><p>Exponentially Weighted</p></li>
<li><p>Equilibrium</p></li>
<li><p>Shrinkage (James-Stein, Bayes-Stein, …)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Covariance:</dt><dd><ul>
<li><p>Empirical</p></li>
<li><p>Gerber</p></li>
<li><p>Denoising</p></li>
<li><p>Denoting</p></li>
<li><p>Exponentially Weighted</p></li>
<li><p>Ledoit-Wolf</p></li>
<li><p>Oracle Approximating Shrinkage</p></li>
<li><p>Shrunk Covariance</p></li>
<li><p>Graphical lasso CV</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Distance estimator:</dt><dd><ul>
<li><p>Pearson Distance</p></li>
<li><p>Kendall Distance</p></li>
<li><p>Spearman Distance</p></li>
<li><p>Covariance Distance (based on any of the above covariance estimators)</p></li>
<li><p>Distance Correlation</p></li>
<li><p>Variation of Information</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Prior estimators:</dt><dd><ul>
<li><p>Empirical</p></li>
<li><p>Black &amp; Litterman</p></li>
<li><p>Factor Model</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Uncertainty Set estimators:</dt><dd><ul>
<li><dl class="simple">
<dt>On Expected Returns:</dt><dd><ul>
<li><p>Empirical</p></li>
<li><p>Circular Bootstrap</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>On Covariance:</dt><dd><ul>
<li><p>Empirical</p></li>
<li><p>Circular bootstrap</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Pre-Selection transformers:</dt><dd><ul>
<li><p>Non-Dominated Selection</p></li>
<li><p>Select K Extremes (Best or Worst)</p></li>
<li><p>Drop Highly Correlated Assets</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Cross-Validation and Model Selection:</dt><dd><ul>
<li><p>Compatible with all <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> methods (KFold, …)</p></li>
<li><p>Walk Forward</p></li>
<li><p>Combinatorial Purged Cross-validation</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Hyper-Parameter Tuning:</dt><dd><ul>
<li><p>Compatible with all <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> methods (GridSearchCV, RandomizedSearchCV, …)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Risk Measures:</dt><dd><ul>
<li><p>Variance</p></li>
<li><p>Semi-Variance</p></li>
<li><p>Mean Absolute Deviation</p></li>
<li><p>First Lower Partial Moment</p></li>
<li><p>CVaR (Conditional Value at Risk)</p></li>
<li><p>EVaR (Entropic Value at Risk)</p></li>
<li><p>Worst Realization</p></li>
<li><p>CDaR (Conditional Drawdown at Risk)</p></li>
<li><p>Maximum Drawdown</p></li>
<li><p>Average Drawdown</p></li>
<li><p>EDaR (Entropic Drawdown at Risk)</p></li>
<li><p>Ulcer Index</p></li>
<li><p>Gini Mean Difference</p></li>
<li><p>Value at Risk</p></li>
<li><p>Drawdown at Risk</p></li>
<li><p>Entropic Risk Measure</p></li>
<li><p>Fourth Central Moment</p></li>
<li><p>Fourth Lower Partial Moment</p></li>
<li><p>Skew</p></li>
<li><p>Kurtosis</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Link to this heading">#</a></h2>
<p>The code snippets below are designed to introduce <code class="docutils literal notranslate"><span class="pre">skfolio</span></code>’s functionality so you can start using it quickly.
For more detailed information see the <a class="reference internal" href="auto_examples/index.html#general-examples"><span class="std std-ref">Examples</span></a>,  <a class="reference internal" href="user_guide/index.html#user-guide"><span class="std std-ref">User Guide</span></a> and <a class="reference internal" href="api.html#api"><span class="std std-ref">API Reference</span></a> .</p>
<section id="preparing-the-data">
<h3>Preparing the data<a class="headerlink" href="#preparing-the-data" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">set_config</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">GridSearchCV</span><span class="p">,</span>
    <span class="n">KFold</span><span class="p">,</span>
    <span class="n">RandomizedSearchCV</span><span class="p">,</span>
    <span class="n">train_test_split</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">loguniform</span>

<span class="kn">from</span> <span class="nn">skfolio</span> <span class="kn">import</span> <span class="n">RatioMeasure</span><span class="p">,</span> <span class="n">RiskMeasure</span>
<span class="kn">from</span> <span class="nn">skfolio.datasets</span> <span class="kn">import</span> <span class="n">load_factors_dataset</span><span class="p">,</span> <span class="n">load_sp500_dataset</span>
<span class="kn">from</span> <span class="nn">skfolio.model_selection</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CombinatorialPurgedCV</span><span class="p">,</span>
    <span class="n">WalkForward</span><span class="p">,</span>
    <span class="n">cross_val_predict</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">skfolio.moments</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DenoiseCovariance</span><span class="p">,</span>
    <span class="n">DenoteCovariance</span><span class="p">,</span>
    <span class="n">EWMu</span><span class="p">,</span>
    <span class="n">GerberCovariance</span><span class="p">,</span>
    <span class="n">ShrunkMu</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">skfolio.optimization</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MeanRisk</span><span class="p">,</span>
    <span class="n">NestedClustersOptimization</span><span class="p">,</span>
    <span class="n">ObjectiveFunction</span><span class="p">,</span>
    <span class="n">RiskBudgeting</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">skfolio.pre_selection</span> <span class="kn">import</span> <span class="n">SelectKExtremes</span>
<span class="kn">from</span> <span class="nn">skfolio.preprocessing</span> <span class="kn">import</span> <span class="n">prices_to_returns</span>
<span class="kn">from</span> <span class="nn">skfolio.prior</span> <span class="kn">import</span> <span class="n">BlackLitterman</span><span class="p">,</span> <span class="n">EmpiricalPrior</span><span class="p">,</span> <span class="n">FactorModel</span>
<span class="kn">from</span> <span class="nn">skfolio.uncertainty_set</span> <span class="kn">import</span> <span class="n">BootstrapMuUncertaintySet</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">load_sp500_dataset</span><span class="p">()</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">prices_to_returns</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="minimum-variance">
<h3>Minimum Variance<a class="headerlink" href="#minimum-variance" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="fit-on-training-set">
<h3>Fit on training set<a class="headerlink" href="#fit-on-training-set" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">weights_</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="predict-on-test-set">
<h3>Predict on test set<a class="headerlink" href="#predict-on-test-set" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">portfolio</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">portfolio</span><span class="o">.</span><span class="n">annualized_sharpe_ratio</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">portfolio</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="maximum-sortino-ratio">
<h3>Maximum Sortino Ratio<a class="headerlink" href="#maximum-sortino-ratio" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">(</span>
    <span class="n">objective_function</span><span class="o">=</span><span class="n">ObjectiveFunction</span><span class="o">.</span><span class="n">MAXIMIZE_RATIO</span><span class="p">,</span>
    <span class="n">risk_measure</span><span class="o">=</span><span class="n">RiskMeasure</span><span class="o">.</span><span class="n">SEMI_VARIANCE</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="denoised-covariance-shrunk-expected-returns">
<h3>Denoised Covariance &amp; Shrunk Expected Returns<a class="headerlink" href="#denoised-covariance-shrunk-expected-returns" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">(</span>
    <span class="n">objective_function</span><span class="o">=</span><span class="n">ObjectiveFunction</span><span class="o">.</span><span class="n">MAXIMIZE_RATIO</span><span class="p">,</span>
    <span class="n">prior_estimator</span><span class="o">=</span><span class="n">EmpiricalPrior</span><span class="p">(</span>
        <span class="n">mu_estimator</span><span class="o">=</span><span class="n">ShrunkMu</span><span class="p">(),</span> <span class="n">covariance_estimator</span><span class="o">=</span><span class="n">DenoiseCovariance</span><span class="p">()</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="uncertainty-set-on-expected-returns">
<h3>Uncertainty Set on Expected Returns<a class="headerlink" href="#uncertainty-set-on-expected-returns" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">(</span>
    <span class="n">objective_function</span><span class="o">=</span><span class="n">ObjectiveFunction</span><span class="o">.</span><span class="n">MAXIMIZE_RATIO</span><span class="p">,</span>
    <span class="n">mu_uncertainty_set_estimator</span><span class="o">=</span><span class="n">BootstrapMuUncertaintySet</span><span class="p">(),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="weight-constraints-transaction-costs">
<h3>Weight Constraints &amp; Transaction Costs<a class="headerlink" href="#weight-constraints-transaction-costs" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">(</span>
    <span class="n">min_weights</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;AAPL&quot;</span><span class="p">:</span> <span class="mf">0.10</span><span class="p">,</span> <span class="s2">&quot;JPM&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">},</span>
    <span class="n">max_weights</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">transaction_costs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;AAPL&quot;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="s2">&quot;RRC&quot;</span><span class="p">:</span> <span class="mf">0.0002</span><span class="p">},</span>
    <span class="n">groups</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;Equity&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Fund&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Bond&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">12</span><span class="p">,</span>
        <span class="p">[</span><span class="s2">&quot;US&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Europe&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Japan&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">linear_constraints</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;Equity &lt;= 0.5 * Bond&quot;</span><span class="p">,</span>
        <span class="s2">&quot;US &gt;= 0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Europe &gt;= 0.5 * Fund&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Japan &lt;= 1&quot;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="risk-parity-on-cvar">
<h3>Risk Parity on CVaR<a class="headerlink" href="#risk-parity-on-cvar" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RiskBudgeting</span><span class="p">(</span><span class="n">risk_measure</span><span class="o">=</span><span class="n">RiskMeasure</span><span class="o">.</span><span class="n">CVAR</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="risk-parity-gerber-covariance">
<h3>Risk Parity &amp; Gerber Covariance<a class="headerlink" href="#risk-parity-gerber-covariance" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">RiskBudgeting</span><span class="p">(</span>
    <span class="n">prior_estimator</span><span class="o">=</span><span class="n">EmpiricalPrior</span><span class="p">(</span><span class="n">covariance_estimator</span><span class="o">=</span><span class="n">GerberCovariance</span><span class="p">())</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="nested-cluster-optimization-with-cross-validation-and-parallelization">
<h3>Nested Cluster Optimization with cross-validation and parallelization<a class="headerlink" href="#nested-cluster-optimization-with-cross-validation-and-parallelization" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">NestedClustersOptimization</span><span class="p">(</span>
    <span class="n">inner_estimator</span><span class="o">=</span><span class="n">MeanRisk</span><span class="p">(</span><span class="n">risk_measure</span><span class="o">=</span><span class="n">RiskMeasure</span><span class="o">.</span><span class="n">CVAR</span><span class="p">),</span>
    <span class="n">outer_estimator</span><span class="o">=</span><span class="n">RiskBudgeting</span><span class="p">(</span><span class="n">risk_measure</span><span class="o">=</span><span class="n">RiskMeasure</span><span class="o">.</span><span class="n">VARIANCE</span><span class="p">),</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">KFold</span><span class="p">(),</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="randomized-search-of-the-l2-norm">
<h3>Randomized Search of the L2 Norm<a class="headerlink" href="#randomized-search-of-the-l2-norm" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">randomized_search</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">MeanRisk</span><span class="p">(),</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">WalkForward</span><span class="p">(</span><span class="n">train_size</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">60</span><span class="p">),</span>
    <span class="n">param_distributions</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;l2_coef&quot;</span><span class="p">:</span> <span class="n">loguniform</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">randomized_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="n">randomized_search</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">weights_</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="grid-search-on-embedded-parameters">
<h3>Grid Search on embedded parameters<a class="headerlink" href="#grid-search-on-embedded-parameters" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">(</span>
    <span class="n">objective_function</span><span class="o">=</span><span class="n">ObjectiveFunction</span><span class="o">.</span><span class="n">MAXIMIZE_RATIO</span><span class="p">,</span>
    <span class="n">risk_measure</span><span class="o">=</span><span class="n">RiskMeasure</span><span class="o">.</span><span class="n">VARIANCE</span><span class="p">,</span>
    <span class="n">prior_estimator</span><span class="o">=</span><span class="n">EmpiricalPrior</span><span class="p">(</span><span class="n">mu_estimator</span><span class="o">=</span><span class="n">EWMu</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)),</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;risk_measure&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">RiskMeasure</span><span class="o">.</span><span class="n">VARIANCE</span><span class="p">,</span>
            <span class="n">RiskMeasure</span><span class="o">.</span><span class="n">CVAR</span><span class="p">,</span>
            <span class="n">RiskMeasure</span><span class="o">.</span><span class="n">VARIANCE</span><span class="o">.</span><span class="n">CDAR</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;prior_estimator__mu_estimator__alpha&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">)</span>
<span class="n">gs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">weights_</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="black-litterman-model">
<h3>Black &amp; Litterman Model<a class="headerlink" href="#black-litterman-model" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">views</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AAPL - BBY == 0.03 &quot;</span><span class="p">,</span> <span class="s2">&quot;CVX - KO == 0.04&quot;</span><span class="p">,</span> <span class="s2">&quot;MSFT == 0.06 &quot;</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">(</span>
    <span class="n">objective_function</span><span class="o">=</span><span class="n">ObjectiveFunction</span><span class="o">.</span><span class="n">MAXIMIZE_RATIO</span><span class="p">,</span>
    <span class="n">prior_estimator</span><span class="o">=</span><span class="n">BlackLitterman</span><span class="p">(</span><span class="n">views</span><span class="o">=</span><span class="n">views</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="factor-model">
<h3>Factor Model<a class="headerlink" href="#factor-model" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">factor_prices</span> <span class="o">=</span> <span class="n">load_factors_dataset</span><span class="p">()</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">prices_to_returns</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">factor_prices</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">(</span><span class="n">prior_estimator</span><span class="o">=</span><span class="n">FactorModel</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">weights_</span><span class="p">)</span>
<span class="n">portfolio</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">portfolio</span><span class="o">.</span><span class="n">calmar_ratio</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">portfolio</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="factor-model-covariance-detoning">
<h3>Factor Model &amp; Covariance Detoning<a class="headerlink" href="#factor-model-covariance-detoning" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">(</span>
    <span class="n">prior_estimator</span><span class="o">=</span><span class="n">FactorModel</span><span class="p">(</span>
        <span class="n">factor_prior_estimator</span><span class="o">=</span><span class="n">EmpiricalPrior</span><span class="p">(</span><span class="n">covariance_estimator</span><span class="o">=</span><span class="n">DenoteCovariance</span><span class="p">())</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="black-litterman-factor-model">
<h3>Black &amp; Litterman Factor Model<a class="headerlink" href="#black-litterman-factor-model" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">factor_views</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MTUM - QUAL == 0.03 &quot;</span><span class="p">,</span> <span class="s2">&quot;SIZE - TLT == 0.04&quot;</span><span class="p">,</span> <span class="s2">&quot;VLUE == 0.06&quot;</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">(</span>
    <span class="n">objective_function</span><span class="o">=</span><span class="n">ObjectiveFunction</span><span class="o">.</span><span class="n">MAXIMIZE_RATIO</span><span class="p">,</span>
    <span class="n">prior_estimator</span><span class="o">=</span><span class="n">FactorModel</span><span class="p">(</span>
        <span class="n">factor_prior_estimator</span><span class="o">=</span><span class="n">BlackLitterman</span><span class="p">(</span><span class="n">views</span><span class="o">=</span><span class="n">factor_views</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="pre-selection-pipeline">
<h3>Pre-Selection Pipeline<a class="headerlink" href="#pre-selection-pipeline" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">set_config</span><span class="p">(</span><span class="n">transform_output</span><span class="o">=</span><span class="s2">&quot;pandas&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;pre_selection&quot;</span><span class="p">,</span> <span class="n">SelectKExtremes</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">highest</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;optimization&quot;</span><span class="p">,</span> <span class="n">MeanRisk</span><span class="p">()),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">portfolio</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="k-fold-cross-validation">
<h3>K-fold Cross-Validation<a class="headerlink" href="#k-fold-cross-validation" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">()</span>
<span class="n">mmp</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="c1"># mmp is the predicted MultiPeriodPortfolio object composed of 5 Portfolios (1 per testing fold)</span>
<span class="n">mmp</span><span class="o">.</span><span class="n">plot_cumulative_returns</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mmp</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="combinatorial-purged-cross-validation">
<h3>Combinatorial Purged Cross-Validation<a class="headerlink" href="#combinatorial-purged-cross-validation" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">MeanRisk</span><span class="p">()</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">CombinatorialPurgedCV</span><span class="p">(</span><span class="n">n_folds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_test_folds</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cv</span><span class="o">.</span><span class="n">get_summary</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>
<span class="n">population</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>
<span class="n">population</span><span class="o">.</span><span class="n">plot_distribution</span><span class="p">(</span>
    <span class="n">measure_list</span><span class="o">=</span><span class="p">[</span><span class="n">RatioMeasure</span><span class="o">.</span><span class="n">SHARPE_RATIO</span><span class="p">,</span> <span class="n">RatioMeasure</span><span class="o">.</span><span class="n">SORTINO_RATIO</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">population</span><span class="o">.</span><span class="n">plot_cumulative_returns</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">population</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="right-next"
       href="user_guide/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">User Guide</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, skfolio developers (BSD License).
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>